## การใช้ฟังก์ชั่น malloc() ##

เราสามารถจองเนื้อที่ในหน่วยความจำ (heap memory) โดยใช้ฟังก์ชัน malloc()

```c
	malloc( size of memory in bytes);
	เช่น 
		malloc(12);              จองเนื้อที่ในหน่วยความจำขนาด 12 bytes
		malloc(sizeof(float));   จองเนื้อที่ในหน่วยความจำขนาดเท่ากับ 4 bytes
		malloc(sizeof(int)*3);   จองเนื้อที่ในหน่วยความจำขนาดเท่ากับ ขนาดของ integer * 3 = 2 * 3 bytes
                                         = 6  bytes
```

* malloc()  เป็นฟังก์ชั่นที่ใช้สำหรับจองเนื้อที่ในหน่วยความจำเอาไว้ใช้งานอะไรก็ได้ เป็นการจองแบบ dynamic นั่นคือ จะใช้เมื่อไหร่ก็จองมา และเมื่อใช้เสร็จก็คืนกลับไป ด้วยฟังก์ชั่น free()

* การใช้ฟังก์ชั่น malloc ในการขอพื้นที่ array ควรใช้กับarray ที่มีขนาดมากๆ เช่น array 1000 ช่องขึ้นไป เพราะ พื้นที่ใน stack อาจจะมีไม่เพียงพอต่อ array นั้นๆ

```c
	เช่น
		int  *a, i;
		a = (int *)malloc( sizeof(int) * 10 );
		assert (a != NULL);

		for(i=0; i < 10 ; i++)
			a[i] = i+5;
		for(i=0; i < 10 ; i++)
			printf(“%d ”, a[i]);
		free(a);
```

อาจเขียนได้อีกแบบ คือ
  
```c
		for(i=0; i < 10 ; i++)
			*(a+i) = i+5;
		for(i=0; i < 10 ; i++)
			printf(“%d ”, *(a+i) );
```

นี่คือตัวอย่างการใช้งานที่ไม่ควรทำ
```c
		int  * intPtr;
		int  x;
		intPtr  =  &i;
		intPtr[0] = 12;	// ok
		intPtr[3] = 13;	// bad
```
เพราะว่า

- สามารถกำหนดขนาดของหน่วยความจำ(เช่น array) ได้ขณะรันโปรแกรม
- สามารถคืนเนื้อที่ในหน่วยความจำที่ได้มาโดยใช้ free()
- สามารถเปลี่ยนแปลงขนาดของ array ขณะรันโปรแกรมได้โดยใช้ realloc()  
```c
  เช่น
      b = realloc(b, sizeof(int)*100);
      ทำให้ใช้เนื้อที่ในหน่วยความจำได้อย่างมีประสิทธิภาพมากขึ้น
```
  
- ต้องจองเนื้อที่ไว้ใช้เอง และต้องจองให้ถูกต้อง (ไม่มีใครมาเช็คให้)
- ต้องไม่ลืมที่จะคืนหน่วยความจำ  และต้องทำเอง
- ถ้าลืมจอง-คืน หรือ ทำผิดขั้นตอน  โปรแกรมอาจไม่แสดงข้อผิดพลาดขณะ compile และทำงานได้ตามปกติ 
	  แต่เมื่อเจอ input บางกรณีอาจทำให้โปรแกรมผิดพลาดและเสียหายได้ ... นั่นคือ ต้องใช้อย่างระมัดระวัง




