<B>Input/output with files</B>

<B>การเปิดไฟล์</B>

ในการทำงานร่วมกับไฟล์สิ่งแรกที่จะต้องทำคือเปิดไฟล์ขึ้นมาก่อน 
โดยการใช้ฟังก์ชัน fopen() ในการเปิดไฟล์
โดยมีรูปแบบการใช้งานดังนี้
~~~
fopen(filename, mode);
~~~
โดยฟังก์ชันนี้จะมีพารามิเตอร์สองตัว คือ filename เป็นชื่อหรือพาท์ธของไฟล์ 
และ mode เป็นโหมดสำหรับการเปิดไฟล์ โดยโหมดของการเปิดไฟล์ในภาษา C จะมีดังนี้
~~~
โหมด	คำอธิบาย
r	เปิดไฟล์เพื่ออ่าน
w	เปิดไฟล์เพื่อเขียน
a	เปิดไฟล์สำหรับการเขียนต่อท้าย
r+	เปิดไฟล์เพื่อทั้งอ่านและเขียน
w+	เปิดไฟล์เพื่ออ่านและเขียนและลบข้อมูลของไฟล์ในตอนเริ่มต้น
a+	เปิดไฟล์เพื่ออ่านและเขียนต่อท้ายไฟล์
~~~

จากตารางข้างบนเป็นการเปิดไฟล์สำหรับ text file และถ้าคุณกำงานกับ binary file คุณต้องใช้โหมดเหล่านี้แทน
~~~
โหมด	คำอธิบาย
rb	เปิดไฟล์เพื่ออ่าน
wb	เปิดไฟล์เพื่อเขียน
ab	เปิดไฟล์สำหรับการเขียนต่อท้าย
rb+	เปิดไฟล์เพื่อทั้งอ่านและเขียน
wb+	เปิดไฟล์เพื่ออ่านและเขียนและลบข้อมูลของไฟล์ในตอนเริ่มต้น
ab+	เปิดไฟล์เพื่ออ่านและเขียนต่อท้ายไฟล์
~~~
<B>การปิดไฟล์</B>

หลังจากเสร็จสิ้นการใช้งานไฟล์แล้วเราจำเป็นต้องปิดไฟล์เพื่อให้ระบบนำไฟล์ไปใช้อย่างอื่นได้ต่อไป 
สำหรับการปิดไฟล์ในภาษา C นั้นเราจะใช้ฟังก์ชัน fclose() โดยการส่งตัวแปรไฟล์มราต้องการปิดไป 
หากสำเร็จฟังก์ชันจะส่งค่า 0 หากไม่จะส่งค่า EOF
มีรูปแบบการใช้คือ;
~~~
fclose(file);
~~~
<B>การเขียนลงบนไฟล์</B>

ในการเขียนข้อมูลลงบน text file คุณสามารถใช้ฟังก์ชันต่างๆ ได้ในภาษา C 
โดยทั่วไปแล้วจะมี 3 ฟังก์ชันที่เราจะใช้ คือ
~~~
fputc() ใช้สำหรับเขียนตัวอักษรลงไปบนไฟล์
fputs() ใช้สำหรับเขียนข้อความที่เป็น string ลงไปบนไฟล์
fprintf() ใช้สำหรับเขียนข้อความที่เป็น string ลงไปบนไฟล์เช่นกัน แต่สามารถจัดรูปแบบการเขียนได้
~~~

<B>ตัวอย่างการเขียนข้อความลงไปบน text file ในภาษา C</B>
~~~
#include <stdio.h>
int main(){
    FILE *fp;

    fp = fopen("example.txt", "w");

    fputs("The first line of writing to the text file.\n", fp);
    fputs("The second line.\n", fp);
    fprintf(fp, "The third line with number %f.\n", 5.43);

    fclose(fp);
    return 0;
}
~~~
ในตัวอย่าง เราได้ทำการเขียนไฟล์ลงไปบนไฟล์ example.txtในตอนแรกเราสร้างตัวแปรไฟล์ขึ้นมา
โดยการใช้คำสั่ง FILE *fp โดยเราเรียกตัวแปรนี้ว่า file pointer ซึ่งตัวแปรจะชี้ไปยังตำแหน่งเริ่มต้น
ของไฟล์เมื่อมันถูกสร้าง ปละเราได้เปิดไฟล์เพื่อเขียนเราใช้โหมดการเปิดเป็น w 
ต่อมาเริ่มทำการเขียนข้อความลงไปบนไฟล์โดยการใช้ฟังก์ชัน fputs() และ fprintf() สำหรับฟังก์ชัน fprintf() 
เราได้จัดรูปแบบของการแสดงผลในตัวเลข มันทำงานคล้ายกับฟังก์ชัน printf() แต่ลงไปบนไฟล์แทน 
ในตอนท้ายเราปิดไฟล์หลังจากที่เขียนเสร็จสิ้นด้วยฟังก์ชัน fclose()

<B>ผลลัพธ์บนไฟล์ example.txt หลังจากการเขียน</B>
~~~
The first line of writing to the text file.
The second line.
The third line with number 5.430000.
~~~

<B>การอ่านจากไฟล์</B>

ในการอ่านข้อมูลจาก text file คุณสามารถใช้ฟังก์ชันต่างๆ 
ได้ในภาษา C ซึ่งจะมี 3 ฟังก์ชัน คือ
~~~
fgetc() ใช้สำหรับอ่านข้อมูลหนึ่งตัวอักษรจากไฟล์
fgets() ใช้สำหรับการอานข้อความเป็นบรรทัดจากไฟล์
fscanf() ใช้สำหรับการอ่านข้อความโดยสิ้นสุดที่ space bar หรือ new line
~~~

ต่อไปมาดูตัวอย่างการอ่านข้อความจากไฟล์ในภาษา C โดยเราจะใช้ไฟล์จากตัวอย่างการหน้าคือ example.txt
~~~~
#include <stdio.h>
int main(){
    FILE *fp;

    fp = fopen("example.txt", "r");
    char buffer[255];

    fgets(buffer, 255, fp);
    printf("%s", buffer);

    fgets(buffer, 255, fp);
    printf("%s", buffer );

    fscanf(fp, "%s", buffer);
    printf("%s\n", buffer);

    fscanf(fp, "%s", buffer);
    printf("%s\n", buffer);

    fclose(fp);
    return 0;
}
~~~
ในตัวอย่างเป็นการอ่านข้อมูลจาก text file example.txt ที่เราได้เพิ่งเขียนลงไปในตัวอย่างก่อนหน้า
ในการเปิดไฟล์เราใช้โหมด r สำหรับการอ่าน และเราประกาศตัวแปร buffer สำหรับใช้พักข้อมูลที่อ่านมาจากไฟล์ 
โดยขนาดของมันต้องเพียงพอกับการอ่านใน 1 ครั้ง ต่อไปเราได้ใช้ฟังก์ชัน fputs ในการอ่าน 
โดยใส่พารามิเตอร์ 3 ตัว ตัวแรกเป็นตัวแปร buffer อันที่สองเป็นขนาดที่ต้องการอ่านคือ 255 
จากตัวอย่าง มันควรจะน้อยกว่าหรือเท่ากับขนาดของตัวแปร buffer เสมอ 
อันที่สามเป็นตัวแปร file pointer ของเรา ต่อมาเราใช้ฟังก์ชัน fscanf() เพื่ออ่าน
โดยมันจะอ่านโดยการใช้ space bar หรือ new line เพื่อสิ้นสุดการอ่าน ซึ่งมันทำงานคล้ายกับฟังก์ชัน scanf()

<B>ผลลัพธ์ของโปรแกรมสำหรับการอ่านไฟล์</B>
~~~
The first line of writing to the text file.
The second line.
The
third
~~~
