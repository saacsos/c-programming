# การจัดสรรหน่วยความจำแบบไดนามิก #
> by [supharom](https://github.com/supharom)

### การจัดสรรพื้นที่ด้วยฟังก์ชัน `malloc()` ###

คือการจองพื้นที่ในหน่วยความจำส่วนที่เรียกว่า ฮีพ (heap) <br>
เมื่อต้องการใช้ฟังก์ชัน `malloc()` ต้อง `#include <stdlib.h>` ไว้ที่ส่วนหัวของโปรแกรมด้วย

รูปแบบ 	`*pt=malloc(size);`

ตัวอย่าง
```c
int *pt;
pt=malloc(6);  //เรียกใช้ฟังก์ชัน malloc() จองพื้นที่ในหน่วยความจำขนาด 6 ไบต์
```

```c
float *pt;
pt=malloc(2*sizeof(float));   // sizeof(float) คือ 4 bytes
```
จึงได้ว่า เรียกใช้ฟังก์ชัน malloc() จองพื้นที่ในหน่วยความจำขนาด 2*4= 8 bytes

### การคืนพื้นที่ในหน่วยความจำด้วยฟังก์ชัน `free()` ###

เมื่อใช้งานพื้นที่ในหน่วยความจำที่จองไว้เรียบร้อยแล้ว ควรคืนพื้นที่ในส่วนนั้นทุกครั้ง โดยใช้ฟังก์ชัน `free()`
```c
free(*pt);  // *pt คือตัวแปรพอยน์เตอร์ที่ชี้ตำแหน่งในหน่วยความจำที่ต้องการคืน
```

ตัวอย่างโปรแกรม
```c
#include <stdio.h>
#include <stdlib.h>

int main()
{
    int *ptr_one;

    ptr_one = (int *)malloc(sizeof(int));  //เรียกใช้ฟังก์ชัน malloc() จองพื้นที่ในหน่วยความจำ

    if (ptr_one == 0) {
        printf("ERROR: Out of memory\n");
        return 1;
    }

    *ptr_one = 25;
    printf("%d\n", *ptr_one);

    free(ptr_one);  //เรียกฟังก์ชัน free() เพื่อเคลี่ยร์พื้นที่ส่วนที่ ptr_one ชี้อยู่

    return 0;
}
```
